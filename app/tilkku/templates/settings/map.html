{% block content %}
{% load static %}

<div class="columns">
    <div class="column is-half">
        <div class="content p-3">
            <div class="field">
                <label class="label">Taustakartta</label>
                <div class="control">
                    <div class="select" style="width: 100%;">
                        <select id="settings-map-bg" onchange="map_select_bg();"></select>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="column is-half">
        <div class="content p-3">
            <div class="field">
                <label class="label">Karttatasot</label>
                <div class="control">
                    <div class="select is-multiple" style="width: 100%;">
                        <select multiple size="8" id="settings-map-layers" onchange="map_select_layers();"></select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

$(document).ready(function() {
    for(var i=0;i<map_servers.length;i++) {
        var selected = "";
        var server = map_servers[i];

        if(settings.map.server == i) selected = " selected";
        $("#settings-map-bg").append("<option value='" + i + "'" + selected + ">" + server.name + "</option>");
    }

    for(var i=0;i<map_layers.length;i++) {
        var selected = "";
        var layer = map_layers[i];

        if(settings.map.layers.includes(i)) selected = " selected";
        $("#settings-map-layers").append("<option value='" + i + "'" + selected + ">" + layer.name + "</option>");
    }
});

function map_select_bg() {
    settings.map.server = $("#settings-map-bg").val();
    refresh_settings();
    map_set_bg();
}

function map_select_layers() {
    settings.map.layers = [];
    $("#settings-map-layers option:selected").each(function() {
        settings.map.layers.push(parseInt($(this).val()));
    });
    refresh_settings();
    map_set_layers();
}
</script>
{% endblock %}